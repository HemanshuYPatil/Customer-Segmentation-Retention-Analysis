(()=>{var e={};e.id=34,e.ids=[34],e.modules={72934:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external.js")},54580:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external.js")},45869:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},20399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},74026:e=>{"use strict";e.exports=require("string_decoder")},98061:e=>{"use strict";e.exports=require("node:assert")},92761:e=>{"use strict";e.exports=require("node:async_hooks")},72254:e=>{"use strict";e.exports=require("node:buffer")},40027:e=>{"use strict";e.exports=require("node:console")},6005:e=>{"use strict";e.exports=require("node:crypto")},65714:e=>{"use strict";e.exports=require("node:diagnostics_channel")},15673:e=>{"use strict";e.exports=require("node:events")},88849:e=>{"use strict";e.exports=require("node:http")},42725:e=>{"use strict";e.exports=require("node:http2")},87503:e=>{"use strict";e.exports=require("node:net")},38846:e=>{"use strict";e.exports=require("node:perf_hooks")},39630:e=>{"use strict";e.exports=require("node:querystring")},84492:e=>{"use strict";e.exports=require("node:stream")},31764:e=>{"use strict";e.exports=require("node:tls")},41041:e=>{"use strict";e.exports=require("node:url")},47261:e=>{"use strict";e.exports=require("node:util")},93746:e=>{"use strict";e.exports=require("node:util/types")},24086:e=>{"use strict";e.exports=require("node:worker_threads")},65628:e=>{"use strict";e.exports=require("node:zlib")},26776:(e,t,r)=>{"use strict";r.r(t),r.d(t,{GlobalError:()=>i.a,__next_app__:()=>p,originalPathname:()=>u,pages:()=>l,routeModule:()=>m,tree:()=>c}),r(82056),r(68032),r(35866),r(48457);var s=r(23191),n=r(88716),o=r(37922),i=r.n(o),a=r(95231),d={};for(let e in a)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(d[e]=()=>a[e]);r.d(t,d);let c=["",{children:["(dashboard)",{children:["predictions",{children:["batch",{children:["[id]",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(r.bind(r,82056)),"C:\\Data-Science-Project\\Customer-Segmentation-Retention-Analysis\\frontend\\app\\(dashboard)\\predictions\\batch\\[id]\\page.tsx"]}]},{}]},{}]},{}]},{layout:[()=>Promise.resolve().then(r.bind(r,68032)),"C:\\Data-Science-Project\\Customer-Segmentation-Retention-Analysis\\frontend\\app\\(dashboard)\\layout.tsx"],"not-found":[()=>Promise.resolve().then(r.t.bind(r,35866,23)),"next/dist/client/components/not-found-error"]}]},{layout:[()=>Promise.resolve().then(r.bind(r,48457)),"C:\\Data-Science-Project\\Customer-Segmentation-Retention-Analysis\\frontend\\app\\layout.tsx"],"not-found":[()=>Promise.resolve().then(r.t.bind(r,35866,23)),"next/dist/client/components/not-found-error"]}],l=["C:\\Data-Science-Project\\Customer-Segmentation-Retention-Analysis\\frontend\\app\\(dashboard)\\predictions\\batch\\[id]\\page.tsx"],u="/(dashboard)/predictions/batch/[id]/page",p={require:r,loadChunk:()=>Promise.resolve()},m=new s.AppPageRouteModule({definition:{kind:n.x.APP_PAGE,page:"/(dashboard)/predictions/batch/[id]/page",pathname:"/predictions/batch/[id]",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:c}})},9002:(e,t,r)=>{Promise.resolve().then(r.bind(r,13370))},13370:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>m});var s=r(10326),n=r(17577),o=r(35047),i=r(33071),a=r(54432),d=r(90772),c=r(25517),l=r(15940),u=r(34474),p=r(567);function m(){let e=(0,o.useParams)(),t=e?.id,[r,m]=(0,n.useState)(""),[h,x]=(0,n.useState)("churn"),[b,f]=(0,n.useState)("desc"),[g,j]=(0,n.useState)([]),[y,v]=(0,n.useState)([]),[S,w]=(0,n.useState)(!1),P=(0,n.useMemo)(()=>[...r?g.filter(e=>String(e.CustomerID??e.customer_id).toLowerCase().includes(r.toLowerCase())):g].sort((e,t)=>{let r="customer"===h?String(e.CustomerID??e.customer_id):"ltv"===h?Number(e.ltv_estimate??0):Number(e.churn_probability??0),s="customer"===h?String(t.CustomerID??t.customer_id):"ltv"===h?Number(t.ltv_estimate??0):Number(t.churn_probability??0);return r<s?"asc"===b?-1:1:r>s?"asc"===b?1:-1:0}),[g,r,h,b]),q=g.length;return(0,s.jsxs)(i.Zb,{children:[s.jsx(i.ll,{children:"Batch Results"}),(0,s.jsxs)(i.SZ,{children:["Showing ",q," customers. Use filters or download the full CSV."]}),(0,s.jsxs)("div",{className:"mt-4 flex flex-wrap items-center gap-3",children:[s.jsx(a.I,{placeholder:"Filter by customer ID",value:r,onChange:e=>m(e.target.value),className:"max-w-xs"}),s.jsx(d.z,{variant:"secondary",onClick:async()=>{let e=await c.h.predictionDownload(t);window.open(e.url,"_blank")},children:"Download full CSV"}),(0,s.jsxs)("div",{className:"ml-auto flex flex-wrap items-center gap-2",children:[(0,s.jsxs)(u.P,{value:h,onChange:e=>x(e.target.value),children:[s.jsx("option",{value:"churn",children:"Sort by churn"}),s.jsx("option",{value:"ltv",children:"Sort by LTV"}),s.jsx("option",{value:"customer",children:"Sort by customer"})]}),(0,s.jsxs)(u.P,{value:b,onChange:e=>f(e.target.value),children:[s.jsx("option",{value:"desc",children:"Descending"}),s.jsx("option",{value:"asc",children:"Ascending"})]})]})]}),s.jsx("div",{className:"mt-4 rounded-xl border border-panelBorder bg-background",children:S?s.jsx("div",{className:"p-4 text-sm text-muted",children:"Loading full results..."}):(0,s.jsxs)(l.iA,{children:[s.jsx(l.Et,{children:(0,s.jsxs)(l.TR,{children:[s.jsx(l.TH,{children:"Risk"}),y.map(e=>s.jsx(l.TH,{children:e},e))]})}),s.jsx(l.XP,{children:P.map((e,t)=>{let r=Number(e.churn_probability??0),n=Number(e.ltv_estimate??0),o=r>=.7?{label:"High Risk",tone:"danger"}:r>=.4?{label:"At Risk",tone:"warning"}:n>=1e3&&r<.3?{label:"Loyal",tone:"success"}:{label:"Stable",tone:"neutral"};return(0,s.jsxs)(l.TR,{children:[s.jsx(l.TD,{children:s.jsx(p.C,{tone:o.tone,children:o.label})}),y.map(r=>s.jsx(l.TD,{children:e[r]},`${r}-${t}`))]},`${e.CustomerID??e.customer_id}-${t}`)})})]})})]})}},567:(e,t,r)=>{"use strict";r.d(t,{C:()=>o});var s=r(10326),n=r(77863);function o({className:e,tone:t="neutral",...r}){return s.jsx("span",{className:(0,n.cn)("inline-flex items-center rounded-full border px-2.5 py-1 text-xs font-medium",{success:"bg-success/20 text-success border-success/40",warning:"bg-warn/20 text-warn border-warn/40",danger:"bg-danger/20 text-danger border-danger/40",neutral:"bg-accentSoft text-accent border-accent/40"}[t],e),...r})}},33071:(e,t,r)=>{"use strict";r.d(t,{SZ:()=>a,Zb:()=>o,ll:()=>i});var s=r(10326),n=r(77863);function o({className:e,...t}){return s.jsx("div",{className:(0,n.cn)("rounded-xl border border-panelBorder bg-panel p-4",e),...t})}function i({className:e,...t}){return s.jsx("h3",{className:(0,n.cn)("text-lg font-semibold",e),...t})}function a({className:e,...t}){return s.jsx("p",{className:(0,n.cn)("text-sm text-muted",e),...t})}},54432:(e,t,r)=>{"use strict";r.d(t,{I:()=>o});var s=r(10326),n=r(77863);function o({className:e,...t}){return s.jsx("input",{className:(0,n.cn)("h-10 w-full rounded-md border border-panelBorder bg-background px-3 text-sm text-text placeholder:text-muted focus:border-accent focus:outline-none focus:ring-2 focus:ring-accent/40",e),...t})}},15940:(e,t,r)=>{"use strict";r.d(t,{Et:()=>i,TD:()=>l,TH:()=>c,TR:()=>d,XP:()=>a,iA:()=>o});var s=r(10326),n=r(77863);function o({className:e,...t}){return s.jsx("table",{className:(0,n.cn)("w-full border-collapse text-sm",e),...t})}function i({className:e,...t}){return s.jsx("thead",{className:(0,n.cn)("text-left text-xs uppercase text-muted",e),...t})}function a({className:e,...t}){return s.jsx("tbody",{className:(0,n.cn)("divide-y divide-panelBorder",e),...t})}function d({className:e,...t}){return s.jsx("tr",{className:(0,n.cn)("hover:bg-panelBorder/40",e),...t})}function c({className:e,...t}){return s.jsx("th",{className:(0,n.cn)("px-4 py-3 font-semibold",e),...t})}function l({className:e,...t}){return s.jsx("td",{className:(0,n.cn)("px-4 py-3",e),...t})}},25517:(e,t,r)=>{"use strict";r.d(t,{h:()=>o});let s=function(){let e=process.env.NEXT_PUBLIC_API_BASE_URL;return e&&e.trim()?e.trim():"https://csr-vx85.onrender.com"}();async function n(e,t){let{auth:n}=await Promise.resolve().then(r.bind(r,20902)),o=n.currentUser,i=o?await o.getIdToken():null,a=o?.uid,d=await fetch(`${s}${e}`,{headers:{"Content-Type":"application/json",...i?{Authorization:`Bearer ${i}`}:{},...a?{"X-Tenant-Id":a}:{}},...t});if(!d.ok)throw Error(`API request failed: ${d.status}`);return d.json()}let o={health:()=>n("/health"),predict:e=>n("/predict",{method:"POST",body:JSON.stringify(e)}),metrics:()=>n("/metrics"),segments:()=>n("/segments"),models:()=>n("/models"),modelDetail:e=>n(`/models/${e}`),modelJson:e=>n(`/models/${e}/json`),modelDataset:e=>n(`/models/${e}/dataset`),defaultModel:()=>n("/models/default"),setDefaultModel:e=>n("/models/default",{method:"POST",body:JSON.stringify({model_id:e})}),predictions:()=>n("/predictions"),predictionDetail:e=>n(`/predictions/${e}`),predictionDownload:e=>n(`/predictions/${e}/download`),predictionCsv:async e=>{let{auth:t}=await Promise.resolve().then(r.bind(r,20902));return fetch(`${s}/predictions/${e}/csv`,{headers:{"Content-Type":"text/csv",...t.currentUser?.uid?{"X-Tenant-Id":t.currentUser.uid}:{}}})},retrain:async e=>{let t=await fetch("/api/queue/train",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)});if(!t.ok)throw Error("Failed to queue training");return t.json()},uploadDataset:async(e,t,r)=>{let n=new FormData;n.append("tenant_id",e),n.append("file",t),r&&n.append("mapping",JSON.stringify(r));let o=await fetch(`${s}/upload`,{method:"POST",body:n});if(!o.ok)throw Error("Upload failed");return o.json()},queueSinglePrediction:async e=>{let t=await fetch("/api/queue/predict-single",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)});if(!t.ok)throw Error(await t.text()||"Failed to queue single prediction");return t.json()},queueBatchPrediction:async e=>{let t=await fetch("/api/queue/predict-batch",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)});if(!t.ok)throw Error("Failed to queue batch prediction");return t.json()}}},82056:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>s});let s=(0,r(68570).createProxy)(String.raw`C:\Data-Science-Project\Customer-Segmentation-Retention-Analysis\frontend\app\(dashboard)\predictions\batch\[id]\page.tsx#default`)}};var t=require("../../../../../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),s=t.X(0,[276,771,496,872,332],()=>r(26776));module.exports=s})();