(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[301],{33300:function(e,t,r){Promise.resolve().then(r.bind(r,77112))},77112:function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return m}});var a=r(57437),n=r(11713),s=r(99376),o=r(66070),l=r(62869),d=r(15883);let i=(0,r(79205).Z)("ChevronLeft",[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]]);var c=r(32489),u=r(2265);function m(){var e,t,r,m,x,h,p,f,b;let g=(0,s.useRouter)(),j=(0,s.useParams)(),v=null==j?void 0:j.id,N=Array.isArray(v)?v[0]:v,[y,w]=(0,u.useState)(!1),k=(0,n.a)({queryKey:["model-detail",N],queryFn:()=>d.h.modelDetail(null!=N?N:""),enabled:!!N}),S=(0,n.a)({queryKey:["model-json",N],queryFn:()=>d.h.modelJson(null!=N?N:""),enabled:!!N,retry:!1}),D=(0,n.a)({queryKey:["model-dataset",N],queryFn:()=>d.h.modelDataset(null!=N?N:""),enabled:!!N&&y,retry:!1}),B=(0,u.useMemo)(()=>{var e,t;return Object.entries(null!==(t=null===(e=k.data)||void 0===e?void 0:e.metrics)&&void 0!==t?t:{}).sort((e,t)=>e[0].localeCompare(t[0]))},[k.data]);return(0,a.jsxs)("div",{className:"grid gap-4",children:[(0,a.jsx)("div",{className:"flex items-center justify-between",children:(0,a.jsxs)(l.z,{variant:"ghost",className:"gap-2",onClick:()=>g.back(),children:[(0,a.jsx)(i,{size:16}),"Back to models"]})}),(0,a.jsxs)(o.Zb,{children:[(0,a.jsx)(o.ll,{children:"Model Details"}),(0,a.jsx)(o.SZ,{children:"Full record pulled from Firestore and stored artifacts."}),(0,a.jsxs)("div",{className:"mt-4 grid gap-3 md:grid-cols-2",children:[(0,a.jsxs)("div",{className:"rounded-xl border border-panelBorder bg-background p-3",children:[(0,a.jsx)("p",{className:"text-xs text-muted",children:"Model name"}),(0,a.jsx)("p",{className:"text-sm font-semibold",children:null!==(h=null===(e=k.data)||void 0===e?void 0:e.name)&&void 0!==h?h:"--"})]}),(0,a.jsxs)("div",{className:"rounded-xl border border-panelBorder bg-background p-3",children:[(0,a.jsx)("p",{className:"text-xs text-muted",children:"Model ID"}),(0,a.jsx)("p",{className:"text-sm font-semibold",children:null!=N?N:"--"})]}),(0,a.jsxs)("div",{className:"rounded-xl border border-panelBorder bg-background p-3",children:[(0,a.jsx)("p",{className:"text-xs text-muted",children:"Created"}),(0,a.jsx)("p",{className:"text-sm font-semibold",children:(null===(t=k.data)||void 0===t?void 0:t.created_at)?function(e){if(!e)return"--";let t=null;if(e instanceof Date&&(t=e),"number"==typeof e&&(t=new Date(e)),"string"==typeof e){let r=new Date(e);t=Number.isNaN(r.getTime())?null:r}if(e.seconds&&(t=new Date(1e3*e.seconds)),e._seconds&&(t=new Date(1e3*e._seconds)),e.toDate&&(t=e.toDate()),e.toMillis&&(t=new Date(e.toMillis())),!t)return"--";let r=Date.now()-t.getTime();if(r<0)return"just now";let a=Math.floor(r/1e3),n=Math.floor(a/60),s=Math.floor(n/60),o=Math.floor(s/24),l=Math.floor(o/30);return a<60?"".concat(a,"s ago"):n<60?"".concat(n,"m ago"):s<24?"".concat(s,"h ago"):o<30?"".concat(o,"d ago"):l<12?"".concat(l,"mo ago"):"".concat(Math.floor(o/365),"y ago")}(k.data.created_at):"--"})]}),(0,a.jsxs)("div",{className:"rounded-xl border border-panelBorder bg-background p-3",children:[(0,a.jsx)("p",{className:"text-xs text-muted",children:"Artifact prefix"}),(0,a.jsx)("p",{className:"truncate text-sm font-semibold",children:null!==(p=null===(r=k.data)||void 0===r?void 0:r.artifact_prefix)&&void 0!==p?p:"--"})]}),(0,a.jsxs)("div",{className:"flex items-end justify-between rounded-xl border border-panelBorder bg-background p-3 md:col-span-2",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-xs text-muted",children:"Training dataset"}),(0,a.jsx)("p",{className:"truncate text-sm font-semibold",children:(null===(m=D.data)||void 0===m?void 0:m.path)||"Dataset path available from training run"})]}),(0,a.jsx)(l.z,{variant:"secondary",onClick:()=>w(!0),children:"View"})]})]})]}),(0,a.jsxs)("div",{className:"grid gap-4 lg:grid-cols-2 auto-rows-fr",children:[(0,a.jsxs)(o.Zb,{children:[(0,a.jsx)(o.ll,{children:"Metrics"}),(0,a.jsx)(o.SZ,{children:"All metrics saved with this model."}),(0,a.jsx)("div",{className:"mt-4 space-y-2",children:0===B.length?(0,a.jsx)("p",{className:"text-sm text-muted",children:"No metrics available."}):B.map(e=>{let[t,r]=e;return(0,a.jsxs)("div",{className:"flex items-center justify-between rounded-lg border border-panelBorder bg-background p-2",children:[(0,a.jsx)("span",{className:"text-xs text-muted",children:t}),(0,a.jsx)("span",{className:"text-sm font-semibold",children:"number"==typeof r?r.toFixed(4):String(r)})]},t)})})]}),(0,a.jsxs)(o.Zb,{className:"flex flex-col",children:[(0,a.jsx)(o.ll,{children:"Raw Firestore Record"}),(0,a.jsx)(o.SZ,{children:"Full document payload from Firestore."}),(0,a.jsx)("div",{className:"mt-4 flex-1 rounded-xl border border-panelBorder bg-background p-3",children:(0,a.jsx)("pre",{className:"no-scrollbar h-full min-h-[18rem] overflow-auto rounded-lg bg-panel/60 p-3 text-xs text-muted",children:JSON.stringify(null!==(f=k.data)&&void 0!==f?f:{},null,2)})})]})]}),S.data&&(0,a.jsxs)(o.Zb,{children:[(0,a.jsx)(o.ll,{children:"JSON Artifacts"}),(0,a.jsx)(o.SZ,{children:"Displays stored JSON files if available."}),(0,a.jsx)("div",{className:"mt-4",children:(0,a.jsxs)("div",{className:"rounded-xl border border-panelBorder bg-background p-3",children:[(0,a.jsx)("p",{className:"text-xs text-muted",children:S.data.filename}),(0,a.jsx)("pre",{className:"mt-2 max-h-72 overflow-auto rounded-lg bg-panel/60 p-3 text-xs text-muted",children:JSON.stringify(S.data.data,null,2)})]})})]}),y&&(0,a.jsx)("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/70 p-6 backdrop-blur-sm",onClick:()=>w(!1),children:(0,a.jsxs)("div",{className:"w-full max-w-6xl rounded-3xl border border-panelBorder bg-panel/95 shadow-[0_24px_60px_rgba(0,0,0,0.45)]",onClick:e=>e.stopPropagation(),children:[(0,a.jsxs)("div",{className:"flex items-center justify-between border-b border-panelBorder px-7 py-5",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-xs uppercase tracking-[0.2em] text-muted",children:"Dataset"}),(0,a.jsx)("h3",{className:"text-xl font-semibold",children:"Training data"}),(0,a.jsx)("p",{className:"mt-1 text-xs text-muted",children:null!==(b=null===(x=D.data)||void 0===x?void 0:x.path)&&void 0!==b?b:"Loading dataset path..."})]}),(0,a.jsx)(l.z,{variant:"ghost",className:"h-9 w-9 rounded-full border border-panelBorder/60 p-0 hover:border-accent/60",onClick:()=>w(!1),"aria-label":"Close",children:(0,a.jsx)(c.Z,{size:16})})]}),(0,a.jsx)("div",{className:"max-h-[70vh] overflow-auto p-6",children:D.isLoading?(0,a.jsx)("p",{className:"text-sm text-muted",children:"Loading dataset..."}):D.data?(0,a.jsx)("div",{className:"overflow-auto rounded-2xl border border-panelBorder bg-background",children:(0,a.jsxs)("table",{className:"min-w-full text-left text-xs",children:[(0,a.jsx)("thead",{className:"sticky top-0 bg-panel/90 text-muted",children:(0,a.jsx)("tr",{children:D.data.columns.map(e=>(0,a.jsx)("th",{className:"border-b border-panelBorder px-3 py-2",children:e},e))})}),(0,a.jsx)("tbody",{children:D.data.rows.map((e,t)=>(0,a.jsx)("tr",{className:"odd:bg-panel/40",children:D.data.columns.map(r=>{var n;return(0,a.jsx)("td",{className:"border-b border-panelBorder px-3 py-2 text-muted",children:String(null!==(n=e[r])&&void 0!==n?n:"")},"".concat(t,"-").concat(r))})},t))})]})}):(0,a.jsx)("p",{className:"text-sm text-muted",children:"Dataset not available."})})]})})]})}},62869:function(e,t,r){"use strict";r.d(t,{z:function(){return o}});var a=r(57437),n=r(2265),s=r(94508);let o=(0,n.forwardRef)((e,t)=>{let{className:r,variant:n="primary",loading:o=!1,disabled:l,children:d,...i}=e;return(0,a.jsxs)("button",{ref:t,className:(0,s.cn)("inline-flex items-center justify-center rounded-md px-4 py-2 text-sm font-medium transition focus:outline-none focus:ring-2 focus:ring-accent/60 disabled:opacity-50",{primary:"bg-accent text-white hover:opacity-90 shadow-glow",secondary:"bg-panel border border-panelBorder text-text hover:bg-accentSoft",ghost:"bg-transparent text-text hover:bg-panel",danger:"bg-danger text-white hover:opacity-90"}[n],r),disabled:l||o,"aria-busy":o||void 0,...i,children:[o&&(0,a.jsx)("span",{className:"mr-2 inline-flex h-4 w-4 animate-spin items-center justify-center rounded-full border-2 border-current border-t-transparent"}),d]})});o.displayName="Button"},66070:function(e,t,r){"use strict";r.d(t,{SZ:function(){return l},Zb:function(){return s},ll:function(){return o}});var a=r(57437),n=r(94508);function s(e){let{className:t,...r}=e;return(0,a.jsx)("div",{className:(0,n.cn)("rounded-xl border border-panelBorder bg-panel p-4",t),...r})}function o(e){let{className:t,...r}=e;return(0,a.jsx)("h3",{className:(0,n.cn)("text-lg font-semibold",t),...r})}function l(e){let{className:t,...r}=e;return(0,a.jsx)("p",{className:(0,n.cn)("text-sm text-muted",t),...r})}},94508:function(e,t,r){"use strict";r.d(t,{cn:function(){return s}});var a=r(61994),n=r(53335);function s(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];return(0,n.m6)((0,a.W)(t))}},79205:function(e,t,r){"use strict";r.d(t,{Z:function(){return d}});var a=r(2265);let n=e=>e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),s=function(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];return t.filter((e,t,r)=>!!e&&""!==e.trim()&&r.indexOf(e)===t).join(" ").trim()};var o={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};let l=(0,a.forwardRef)((e,t)=>{let{color:r="currentColor",size:n=24,strokeWidth:l=2,absoluteStrokeWidth:d,className:i="",children:c,iconNode:u,...m}=e;return(0,a.createElement)("svg",{ref:t,...o,width:n,height:n,stroke:r,strokeWidth:d?24*Number(l)/Number(n):l,className:s("lucide",i),...m},[...u.map(e=>{let[t,r]=e;return(0,a.createElement)(t,r)}),...Array.isArray(c)?c:[c]])}),d=(e,t)=>{let r=(0,a.forwardRef)((r,o)=>{let{className:d,...i}=r;return(0,a.createElement)(l,{ref:o,iconNode:t,className:s("lucide-".concat(n(e)),d),...i})});return r.displayName="".concat(e),r}},32489:function(e,t,r){"use strict";r.d(t,{Z:function(){return a}});let a=(0,r(79205).Z)("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]])},99376:function(e,t,r){"use strict";var a=r(35475);r.o(a,"useParams")&&r.d(t,{useParams:function(){return a.useParams}}),r.o(a,"usePathname")&&r.d(t,{usePathname:function(){return a.usePathname}}),r.o(a,"useRouter")&&r.d(t,{useRouter:function(){return a.useRouter}})},15883:function(e,t,r){"use strict";r.d(t,{h:function(){return o}});var a=r(40257);let n=function(){let e=a.env.NEXT_PUBLIC_API_BASE_URL;return e&&e.trim()?e.trim():"https://csr-vx85.onrender.com"}();async function s(e,t){let{auth:a}=await Promise.all([r.e(139),r.e(685),r.e(293)]).then(r.bind(r,17293)),s=a.currentUser,o=s?await s.getIdToken():null,l=null==s?void 0:s.uid,d=await fetch("".concat(n).concat(e),{headers:{"Content-Type":"application/json",...o?{Authorization:"Bearer ".concat(o)}:{},...l?{"X-Tenant-Id":l}:{}},...t});if(!d.ok)throw Error("API request failed: ".concat(d.status));return d.json()}let o={health:()=>s("/health"),predict:e=>s("/predict",{method:"POST",body:JSON.stringify(e)}),metrics:()=>s("/metrics"),segments:()=>s("/segments"),models:()=>s("/models"),modelDetail:e=>s("/models/".concat(e)),modelJson:e=>s("/models/".concat(e,"/json")),modelDataset:e=>s("/models/".concat(e,"/dataset")),defaultModel:()=>s("/models/default"),setDefaultModel:e=>s("/models/default",{method:"POST",body:JSON.stringify({model_id:e})}),predictions:()=>s("/predictions"),predictionDetail:e=>s("/predictions/".concat(e)),predictionDownload:e=>s("/predictions/".concat(e,"/download")),predictionCsv:async e=>{var t;let{auth:a}=await Promise.all([r.e(139),r.e(685),r.e(293)]).then(r.bind(r,17293));return fetch("".concat(n,"/predictions/").concat(e,"/csv"),{headers:{"Content-Type":"text/csv",...(null===(t=a.currentUser)||void 0===t?void 0:t.uid)?{"X-Tenant-Id":a.currentUser.uid}:{}}})},retrain:async e=>{let t=await fetch("/api/queue/train",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)});if(!t.ok)throw Error("Failed to queue training");return t.json()},uploadDataset:async(e,t,r)=>{let a=new FormData;a.append("tenant_id",e),a.append("file",t),r&&a.append("mapping",JSON.stringify(r));let s=await fetch("".concat(n,"/upload"),{method:"POST",body:a});if(!s.ok)throw Error("Upload failed");return s.json()},queueSinglePrediction:async e=>{let t=await fetch("/api/queue/predict-single",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)});if(!t.ok)throw Error(await t.text()||"Failed to queue single prediction");return t.json()},queueBatchPrediction:async e=>{let t=await fetch("/api/queue/predict-batch",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)});if(!t.ok)throw Error("Failed to queue batch prediction");return t.json()}}}},function(e){e.O(0,[432,763,713,971,117,744],function(){return e(e.s=33300)}),_N_E=e.O()}]);